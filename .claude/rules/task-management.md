# Управление задачами

## Встроенный TodoWrite

### Когда использовать

| Ситуация | Использовать TodoWrite? |
|----------|------------------------|
| Задача из 3+ шагов | Да |
| Сложная задача требует планирования | Да |
| Пользователь дал список задач | Да |
| Trivial изменение | Нет |
| Одношаговая операция | Нет |

### Правила работы

1. **Создание списка** — в начале сложной задачи
2. **Один in_progress** — только одна задача одновременно
3. **Немедленная отметка** — completed сразу после завершения
4. **Добавление новых** — при обнаружении дополнительных шагов

### Статусы задач

| Статус | Описание |
|--------|----------|
| `pending` | Задача запланирована, не начата |
| `in_progress` | Активно выполняется |
| `completed` | Успешно завершена |

### Пример использования

```
Задача пользователя: "Добавить endpoint получения статуса заказа"

TodoWrite:
1. [in_progress] Исследовать существующий API заказов
2. [pending] Спроектировать структуру ответа
3. [pending] Реализовать функцию получения статуса
4. [pending] Добавить маршрут в HTTP-сервис
5. [pending] Проверить через MCP syntaxcheck
6. [pending] Обновить документацию API
```

---

## TASK.md — Файл текущей задачи

### Назначение

Детальное описание текущей задачи для сохранения контекста между сессиями.

### Структура

```markdown
# Текущая задача

## Описание
[Краткое описание задачи]

## Требования
- [ ] Требование 1
- [ ] Требование 2

## Контекст
- Связанные файлы: ...
- Зависимости: ...
- Ограничения: ...

## План реализации
1. Шаг 1
2. Шаг 2
3. ...

## Прогресс
- [x] Выполнено: ...
- [ ] В работе: ...
- [ ] Осталось: ...

## Заметки
[Важные наблюдения, решения, вопросы]
```

### Когда создавать

- Задача требует несколько сессий
- Сложная задача с множеством компонентов
- Нужно сохранить контекст для продолжения

---

## Интеграция с внешними трекерами

### Yougile

#### Конфигурация

```json
// .claude/yougile-config.json
{
  "cli_path": "path/to/yougile.exe",
  "project_id": "uuid",
  "boards": {
    "product_backlog": "uuid",
    "sprint": "uuid"
  },
  "columns": {
    "backlog": "uuid",
    "todo": "uuid",
    "in_progress": "uuid",
    "review": "uuid",
    "done": "uuid"
  }
}
```

#### Workflow

1. **Начало сессии:**
   ```bash
   yougile task list --column-id <in_progress_id>
   ```

2. **Начало работы над задачей:**
   ```bash
   yougile task move <task_id> --column-id <in_progress_id>
   ```

3. **Завершение задачи:**
   ```bash
   yougile task move <task_id> --column-id <done_id>
   yougile task complete <task_id>
   ```

#### Цвета колонок

| Цвет | Код | Статус |
|------|-----|--------|
| Серый | 1 | Backlog |
| Синий | 3 | To Do / Ready |
| Жёлтый | 5 | In Progress |
| Оранжевый | 6 | Review |
| Красный | 7 | Blocked |
| Зелёный | 10 | Done |

### Jira

#### Конфигурация

```json
// .claude/jira-config.json
{
  "base_url": "https://company.atlassian.net",
  "project_key": "PROJ",
  "transitions": {
    "to_do": "11",
    "in_progress": "21",
    "review": "31",
    "done": "41"
  }
}
```

#### Workflow

1. **Получить задачу:**
   ```bash
   curl -u user:token "${JIRA_URL}/rest/api/2/issue/PROJ-123"
   ```

2. **Изменить статус:**
   ```bash
   curl -X POST -u user:token \
     "${JIRA_URL}/rest/api/2/issue/PROJ-123/transitions" \
     -H "Content-Type: application/json" \
     -d '{"transition": {"id": "21"}}'
   ```

### GitHub Issues

#### Workflow

```bash
# Список задач
gh issue list --label "in-progress"

# Создать задачу
gh issue create --title "Задача" --body "Описание"

# Закрыть задачу
gh issue close 123 --comment "Выполнено в коммите abc123"
```

---

## Структура задач в проекте

### Типы задач

| Префикс | Тип | Описание |
|---------|-----|----------|
| `FEAT` | Feature | Новая функциональность |
| `FIX` | Bug fix | Исправление ошибки |
| `REFACTOR` | Refactoring | Улучшение кода |
| `DOC` | Documentation | Документация |
| `TEST` | Testing | Тесты |
| `META` | Metadata | Создание объектов метаданных |

### Формат идентификатора

```
{PREFIX}-{NUMBER}[-{SUBNUMBER}]

Примеры:
FEAT-1        # Feature задача
FEAT-1.1      # Подзадача
FIX-23        # Bug fix
META-5        # Задача на создание метаданных
```

### Разделение задач Claude Code / Пользователь

| Тип | Исполнитель | Пример |
|-----|-------------|--------|
| `META-*` | Пользователь | Создание документа в Конфигураторе |
| `1C-*` | Claude Code | Написание кода модуля |
| `DOC-*` | Claude Code | Документация |
| `TEST-*` | Оба | Тесты (сценарии + реализация) |

---

## Приоритизация задач

### Матрица приоритетов

| | Срочно | Не срочно |
|---|--------|-----------|
| **Важно** | 1 - Сделать сейчас | 2 - Запланировать |
| **Не важно** | 3 - Делегировать | 4 - Отложить/Удалить |

### Метки приоритета

| Метка | Описание | SLA |
|-------|----------|-----|
| `critical` | Блокирует работу | Немедленно |
| `high` | Важная функциональность | 1-2 дня |
| `medium` | Стандартная задача | Текущий спринт |
| `low` | Улучшения | Backlog |

---

## Синхронизация состояния

### Файл состояния

```json
// .claude/task-state.json
{
  "last_sync": "2026-01-15T10:30:00Z",
  "current_task": {
    "id": "FEAT-123",
    "title": "Добавить endpoint статуса",
    "status": "in_progress",
    "started_at": "2026-01-15T09:00:00Z"
  },
  "completed_today": [
    "FIX-120",
    "FIX-121"
  ]
}
```

### Правила синхронизации

1. **Начало сессии** — проверить изменения в трекере
2. **Перед началом задачи** — синхронизировать статус
3. **После завершения** — обновить трекер
4. **Конец сессии** — сохранить состояние

---

## Отчётность

### Дневной отчёт

```markdown
## Отчёт за [дата]

### Выполнено
- FEAT-123: Добавлен endpoint статуса заказа
- FIX-120: Исправлен расчёт скидки

### В работе
- FEAT-124: Batch-операции (80%)

### Блокеры
- META-15: Ожидание создания регистра

### План на завтра
- Завершить FEAT-124
- Начать FEAT-125
```

### Метрики

| Метрика | Как измерять |
|---------|--------------|
| Velocity | Задач/спринт |
| Lead time | Время от создания до done |
| Cycle time | Время от in_progress до done |
| Throughput | Задач/день |
